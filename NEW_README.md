–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º

1. –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞

üìÅ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (ports)

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ (gRPC-–∫–ª–∏–µ–Ω—Ç—ã, Kafka-–ø–∞–±–ª–∏—à–µ—Ä—ã –∏ –ø—Ä.) –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤:

internal/**/ports/ –≠—Ç–æ —Ç–µ—Ä–±—É–µ—Ç –∫–æ–º–∞–Ω–¥ make generate-mocks

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ usecase-—Å–ª–æ–µ, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî –≤ adapters.

üåê HTTP-—Ä–æ—É—Ç—ã –∏ Swagger

–í—Å–µ HTTP-—Ä–æ—É—Ç—ã –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ RegisterRoutes, –Ω–∞–ø—Ä–∏–º–µ—Ä:

func RegisterRoutes(mux *http.ServeMux, handler *Handler) {
    // @Summary –õ–æ–≥–∏–Ω
    // @Description –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–¥–∞—á–∞ JWT
    // ...
    mux.HandleFunc("/login", handler.Login)
}

–§–∞–π–ª —Å —Ä–æ—É—Ç–∞–º–∏ –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è routes.go –∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –≤ –æ–¥–Ω–æ–π –∏–∑ –ø–∞–ø–æ–∫:

internal/**/http

Swagger-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –Ω–∞–¥ mux.HandleFunc(...) –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ. –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–∞–Ω–¥–∞ make swagger-init

2. auth-service

üì± HTTP API (–Ω–∞—Ä—É–∂—É)

POST /login ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

POST /register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è


üîå gRPC API (–≤–Ω—É—Ç—Ä—å —Å–∏—Å—Ç–µ–º—ã)

rpc ValidateToken(ValidateTokenRequest) returns (ValidateTokenResponse);

üìÅ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: authpb/auth.protoüîπ –°–µ—Ä–≤–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ auth-service

üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

auth-service –ø–æ gRPC –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ user-service:

CreateUser(email, passwordHash) ‚Üí userID

GetByEmail(email) ‚Üí userID, passwordHash

